<div class="container">

  <!-- ================= HEADER ================= -->
  <div class="header">
    <h2>{{ ui.title }}</h2>
    <button class="btn-add" (click)="openModal()">
      <span>+</span> {{ ui.addUser }}
    </button>
  </div>

  <!-- ================= TABLE ================= -->
  <table class="table">
    <thead>
      <tr>
        <th>{{ ui.thNom }}</th>
        <th>{{ ui.thPrenom }}</th>
        <th>{{ ui.thEmail }}</th>
        <th>{{ ui.thRole }}</th>
        <th>{{ ui.thActions }}</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let u of users; let i = index">
        <td>{{ u.nom }}</td>
        <td>{{ u.prenom }}</td>
        <td>{{ u.email }}</td>
        <td>{{ u.role }}</td>

        <td class="actions">
          <button class="icon edit" (click)="openEditModal(u)">‚úèÔ∏è</button>
          <button class="icon delete" (click)="delete(i)">üóëÔ∏è</button>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- ================= MODAL EDIT ================= -->
<div class="modal-backdrop" *ngIf="editModalOpen && editUser">
  <div class="modal">
    <h2>{{ ui.editTitle }}</h2>

    <form (ngSubmit)="updateUser()" #editForm="ngForm" class="form-grid">

      <div class="col">

        <label>{{ ui.labelNom }} :</label>
        <input
          type="text"
          [(ngModel)]="editUser.nom"
          name="edit_nom"
          required
        >

        <label>{{ ui.labelPrenom }} :</label>
        <input
          type="text"
          [(ngModel)]="editUser.prenom"
          name="edit_prenom"
          required
        >

        <label>{{ ui.labelEmail }} :</label>
        <input
          type="email"
          [(ngModel)]="editUser.email"
          name="edit_email"
          #editEmail="ngModel"
          required
          pattern="^[a-zA-Z0-9._%+-]+@teamwillgroup\.com$"
        >

        <div *ngIf="editEmail.invalid && editEmail.touched">
          {{ ui.emailError }}
        </div>

        <label>{{ ui.labelRole }} :</label>
        <select
          [(ngModel)]="editUser.id_role"
          name="edit_role"
          required
        >
          <option *ngFor="let r of roles" [value]="r.id_role">
            {{ r.libelle }}
          </option>
        </select>
      </div>

      <div class="col">

        <label>{{ ui.labelPasswordOpt }} :</label>
        <input
          type="password"
          [(ngModel)]="editUser.password"
          name="edit_password"
        >

        <div class="modal-actions full-width">
          <button type="submit" class="btn-save">
            {{ ui.update }}
          </button>
          <button
            type="button"
            class="btn-cancel"
            (click)="closeEditModal()"
          >
            {{ ui.cancel }}
          </button>
        </div>
      </div>

    </form>
  </div>
</div>

<!-- ================= MODAL ADD ================= -->
<div class="modal-backdrop" *ngIf="modalOpen">
  <div class="modal">
    <h2>{{ ui.addTitle }}</h2>

    <form (ngSubmit)="saveUser()" #form="ngForm" class="form-grid">

      <div class="col">

        <label>{{ ui.labelNom }} :</label>
        <input
          type="text"
          [(ngModel)]="newUser.nom"
          name="nom"
          required
        >

        <label>{{ ui.labelPrenom }} :</label>
        <input
          type="text"
          [(ngModel)]="newUser.prenom"
          name="prenom"
          required
        >

        <label>{{ ui.labelEmail }} :</label>
        <input
          type="email"
          [(ngModel)]="newUser.email"
          name="email"
          #email="ngModel"
          required
          pattern="^[a-zA-Z0-9._%+-]+@teamwillgroup\.com$"
        >

        <div *ngIf="email.invalid && email.touched">
          {{ ui.emailError }}
        </div>

        <label>{{ ui.labelRole }} :</label>
        <select
          [(ngModel)]="newUser.id_role"
          name="role"
          required
        >
          <option *ngFor="let r of roles" [value]="r.id_role">
            {{ r.libelle }}
          </option>
        </select>
      </div>

      <div class="col">

        <label>{{ ui.labelPassword }} :</label>
        <input
          type="password"
          [(ngModel)]="newUser.password"
          name="password"
          required
        >

        <div class="modal-actions full-width">
          <button type="submit" class="btn-save">
            {{ ui.save }}
          </button>
          <button
            type="button"
            class="btn-cancel"
            (click)="closeModal()"
          >
            {{ ui.cancel }}
          </button>
        </div>
      </div>

    </form>
  </div>
</div>
